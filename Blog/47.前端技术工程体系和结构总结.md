# 前端技术体系和结构



由于前端触及的领域越来越宽，而且每条业务线的开发都有相同和不行痛的部分，所以通过公司业务实践和思考，从整体的角度对前端的体系做下总结。

目前的技术体系(正在用和正在开发的)包括这几个方面：

* 规范 (开发、构建、测试、发布、运行)
* 技术栈
* 开发、构建工具
* 测试 (接口测试、自动化测试)
* 发布流程 发布平台
* 监控和统计系统 (异常监控 性能监控 服务监控)

![](https://raw.githubusercontent.com/ccforward/cc/master/Blog/pic/fe-tech.png)



### 规范

js 基于 ES6 开发，用 stylus 做预处理器来提升 css 代码的可维护性(sass也是其他项目的可选项)，gulp/webpack+babel 做构建工具
固定项目的目录结构，方便统一构建的方式。  
用 git 做版本控制，每次新需求都从 master 分支 checkout 出来，用 ESLint 静态检查做强制约束，通过 git 的 hook 保证 ESLint 不通过 git 就不能提交代码。  
直接通过 git 发布当亲开发分支的静态代码，每次发布打版本 tag ，通过服务器的脚本自动将分支合并到master。  

## 技术栈 & 构建

前后端分离

Vue.js zepto stylus React 都可选，根据业务的不同选择最优方案。同时用 Yeoman 开发出对应的脚手架工具，通过脚手架快速进行项目的而搭建和组件的开发

前端技术栈更新太快，所以技术栈的更新也配合开发构建工具的更新，这就像业务一样是个不断发展的过程。

根据构建需求开发 webpack 和 gulp 的插件来适应技术栈的更新和业务的需求。

因为用的都是开源的模块和框架，所以用 NPM 作为团队统一的包管理工具。如果后期内部的组件和模块丰富了，可以搭建一套内部的 NPM 来做包管理。

#### Mock 接口数据 

前后端开发不可能同步，所以开发一个 API Mock 平台来模拟 api 返回的数据，好处如下：

* 约定好接口数据后，前端不依赖后端
* 方便做各种接口数据的边界条件测试
* 前端可以方便快速做接口的单元测试
* 产品经理也能快速根据假数据做产品原型的调整
* 测试的同学也可以根据 Mock 平台上的假数据提前跑测试用例

> PS:这个 API Mock 平台正在开发中，简称 AMP(API Mock Platform)

## 测试

痛点：
* 写了一大坨的代码出现 bug 却不知道哪里导致的
* 做完一个功能后需要反复测试所有的功能

所以基于前端 TDD (Test-Driven Development 测试驱动开发) 能省时省力

有了 APM 平台也能快速的做接口的单元测试

> 关于 TDD 后面专门开一篇文章做总结

## 发布

代码做过rview 并通过测试后进入发布流程

* 通过 git 的 hook 和服务器脚本来快速的一键发布前端静态资源到CDN
* 少数前后端不分离的项目需要通过 jenkins 或内部发布平台来快速发布

## 统计 & 监控

现在的统计监控是基于公司的一套上报系统来做的，后端已经相对完整，只需要前端做数据的上报即可。

但是现在的数据只是收集，还需要搭建一套通知系统，保证出现线上故障能够快速的修复

* 可用性监控：页面访问成功率 接口成功率
* 异常监控：收集页面异常信息
* 性能监控：统计页面首屏和 onload 加载的时间









